(()=>{var e={};e.id=931,e.ids=[931],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},9820:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},8631:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),s(908),s(9776),s(5866);var a=s(3191),r=s(8716),n=s(7922),i=s.n(n),l=s(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,908)),"/Users/junbookpro/Documents/study/vacant-shop-map/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,9776)),"/Users/junbookpro/Documents/study/vacant-shop-map/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/junbookpro/Documents/study/vacant-shop-map/app/page.tsx"],u="/page",h={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},5196:(e,t,s)=>{Promise.resolve().then(s.bind(s,5787))},5787:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>es});var a,r=s(326),n=s(7577),i=s(6226),l=s(551);let o={rentRange:[0,1e3],areaRange:[0,100],shopTypes:["restaurant","retail","office","etc"],region:void 0},c=(0,l.Ue)((e,t)=>({filters:o,appliedFilters:o,isFilterPanelOpen:!1,setFilters:t=>{e({filters:t})},applyFilters:t=>{e({filters:t,appliedFilters:t,isFilterPanelOpen:!1})},openFilterPanel:()=>{e({isFilterPanelOpen:!0})},closeFilterPanel:()=>{e({isFilterPanelOpen:!1})},resetFilters:()=>{e({filters:o,appliedFilters:o})},isDefaultFilter:()=>{let{appliedFilters:e}=t();return e.rentRange[0]===o.rentRange[0]&&e.rentRange[1]===o.rentRange[1]&&e.areaRange[0]===o.areaRange[0]&&e.areaRange[1]===o.areaRange[1]&&e.shopTypes.length===o.shopTypes.length&&e.shopTypes.every(e=>o.shopTypes.includes(e))&&!e.region}}));function d(){let[e,t]=(0,n.useState)(!1),[s,a]=(0,n.useState)(!0),{openFilterPanel:l}=c();return(0,r.jsxs)("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white/95 backdrop-blur-sm border-b border-gray-200 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"relative w-8 h-8 flex-shrink-0",children:r.jsx(i.default,{src:"/logo.png",alt:"공실 상가 지도 로고",width:32,height:32,className:"w-full h-full object-contain",priority:!0})}),s&&(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-lg font-bold text-gray-900 leading-tight",children:"공실상가지도"}),r.jsx("p",{className:"text-xs text-gray-500 leading-none",children:"빈 상가를 쉽게 찾아보세요"})]})]}),r.jsx("div",{className:"flex items-center space-x-2",children:e&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{onClick:l,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"필터 열기",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.707A1 1 0 013 7V4z"})})}),r.jsx("button",{onClick:()=>a(!s),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors sm:hidden","aria-label":"제목 토글",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:s?"M6 18L18 6M6 6l12 12":"M4 6h16M4 12h16M4 18h16"})})})]})})]}),r.jsx("div",{className:"h-0.5 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 transform origin-left scale-x-0 transition-transform duration-300 group-hover:scale-x-100"})]})}function u(){return r.jsx("div",{className:"h-16"})}function h({title:e="데이터 로딩 실패",message:t="데이터를 불러오는 중 오류가 발생했습니다.",errorCode:s,onRetry:a,showDetails:n=!1,className:i="",size:l="medium"}){let o={small:{container:"p-3",icon:"w-8 h-8",title:"text-sm font-medium",message:"text-xs",button:"px-3 py-1 text-sm"},medium:{container:"p-4",icon:"w-12 h-12",title:"text-lg font-semibold",message:"text-sm",button:"px-4 py-2"},large:{container:"p-6",icon:"w-16 h-16",title:"text-xl font-bold",message:"text-base",button:"px-6 py-3 text-lg"}}[l];return(0,r.jsxs)("div",{className:`text-center ${o.container} ${i}`,children:[r.jsx("div",{className:"flex justify-center mb-4",children:r.jsx("svg",{className:`${o.icon} mx-auto text-red-500`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsx("h3",{className:`${o.title} text-gray-900 mb-2`,children:e}),r.jsx("p",{className:`${o.message} text-gray-600 mb-4`,children:t}),s&&r.jsx("div",{className:"mb-4",children:(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:["오류 코드: ",s]})}),a&&r.jsx("button",{onClick:a,className:`
            ${o.button}
            bg-blue-500 text-white rounded-lg font-medium
            hover:bg-blue-600 active:bg-blue-700
            transition-colors duration-200
            focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2
          `,children:"다시 시도"}),n&&!1]})}let m={mapInstance:null,isMapLoaded:!1,center:{lat:35.22889,lng:129.0813095},zoom:15,isLoading:!1,error:null,markers:[],mapMarkers:[],selectedMarkerId:null,hoveredMarkerId:null},x=(0,l.Ue)((e,t)=>({...m,setMapInstance:t=>e({mapInstance:t,isMapLoaded:!!t}),setMapLoaded:t=>e({isMapLoaded:t}),setCenter:t=>e({center:t}),setZoom:t=>e({zoom:t}),setLoading:t=>e({isLoading:t}),setError:t=>e({error:t}),resetMap:()=>e(m),setMarkers:t=>e({markers:t}),setMapMarkers:t=>e({mapMarkers:t}),setSelectedMarkerId:t=>e({selectedMarkerId:t}),setHoveredMarkerId:t=>e({hoveredMarkerId:t}),clearAllMarkers:()=>{let{markers:s}=t();s.forEach(e=>{e&&e.setMap&&e.setMap(null)}),e({markers:[],mapMarkers:[],selectedMarkerId:null,hoveredMarkerId:null})}}));var p=s(2889);let g=()=>!1;function f({shops:e,onMarkerClick:t}){let{mapInstance:s,isMapLoaded:a,markers:r,mapMarkers:i,selectedMarkerId:l,hoveredMarkerId:o,setMarkers:c,setMapMarkers:d,setSelectedMarkerId:u,setHoveredMarkerId:h,clearAllMarkers:m}=x();(0,n.useRef)(new p.Z({radius:80,maxZoom:16,minZoom:0,minPoints:2}));let[f,b]=(0,n.useState)(13);return(0,n.useCallback)(e=>{switch(e){case"restaurant":return"/markers/restaurant.svg";case"retail":return"/markers/retail.svg";case"office":return"/markers/office.svg";default:return"/markers/etc.svg"}},[]),(0,n.useCallback)(e=>{if(!g())return console.warn("⚠️ Naver Maps not available for cluster icon creation"),null;let t=e<10?40:e<100?50:60;try{return{content:`<div style="
          width: ${t}px;
          height: ${t}px;
          background-color: ${e<10?"#4285F4":e<100?"#FF6B35":"#E53E3E"};
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          font-weight: bold;
          font-size: ${t<50?"12px":"14px"};
          border: 3px solid white;
          box-shadow: 0 2px 6px rgba(0,0,0,0.3);
          cursor: pointer;
        ">${e}</div>`,size:new window.naver.maps.Size(t,t),anchor:new window.naver.maps.Point(t/2,t/2)}}catch(e){return console.error("❌ Failed to create cluster icon:",e),null}},[]),(0,n.useCallback)(e=>e.map(e=>({type:"Feature",properties:{cluster:!1,shopId:e.id,name:e.name,shopType:e.shopType,monthlyRent:e.monthlyRent},geometry:{type:"Point",coordinates:[e.longitude,e.latitude]}})),[]),null}!function(e){e.PERMISSION_DENIED="PERMISSION_DENIED",e.POSITION_UNAVAILABLE="POSITION_UNAVAILABLE",e.TIMEOUT="TIMEOUT",e.NOT_SUPPORTED="NOT_SUPPORTED"}(a||(a={}));class b extends Error{constructor(e,t,s){super(t),this.type=e,this.code=s,this.name="GeolocationError"}}let j={enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4},y=()=>"undefined"!=typeof navigator&&"geolocation"in navigator,v=async()=>{if("undefined"==typeof navigator||!navigator.permissions)return"unsupported";try{return(await navigator.permissions.query({name:"geolocation"})).state}catch{return"unsupported"}},N=(e=j)=>new Promise((t,s)=>{if(!y()){s(new b("NOT_SUPPORTED","이 브라우저는 위치 서비스를 지원하지 않습니다."));return}navigator.geolocation.getCurrentPosition(e=>{t(e)},e=>{let t,a;switch(console.error("❌ 위치 정보 획득 실패:",e),e.code){case e.PERMISSION_DENIED:t="PERMISSION_DENIED",a="위치 정보 접근이 거부되었습니다. 브라우저 설정에서 위치 권한을 허용해주세요.";break;case e.POSITION_UNAVAILABLE:t="POSITION_UNAVAILABLE",a="위치 정보를 사용할 수 없습니다. GPS나 네트워크 연결을 확인해주세요.";break;case e.TIMEOUT:t="TIMEOUT",a="위치 정보 요청이 시간 초과되었습니다. 다시 시도해주세요.";break;default:t="POSITION_UNAVAILABLE",a="위치 정보를 가져올 수 없습니다."}s(new b(t,a,e.code))},e)});function w({className:e="",onLocationFound:t,onError:s}){let[i,l]=(0,n.useState)(!1),[o,c]=(0,n.useState)(null),{mapInstance:d,setCenter:u}=x(),h=async()=>{if(!d){console.warn("⚠️ Map instance not available");return}if(!y()){let e="이 브라우저는 위치 서비스를 지원하지 않습니다.";c(e),s?.(new b(a.NOT_SUPPORTED,e));return}try{l(!0),c(null),await v();let e=await N({enableHighAccuracy:!0,timeout:1e4,maximumAge:3e4}),{latitude:s,longitude:a}=e.coords;if(window.naver&&window.naver.maps){let e=new window.naver.maps.LatLng(s,a);d.setCenter(e),d.setZoom(16)}u({lat:s,lng:a}),t?.(e),c(null)}catch(e){console.error("❌ 현재 위치 이동 실패:",e),c(e instanceof b?e.message:"위치 정보를 가져올 수 없습니다."),s?.(e),setTimeout(()=>{c(null)},3e3)}finally{l(!1)}};return(0,r.jsxs)("div",{className:`absolute bottom-32 right-4 z-20 ${e}`,children:[r.jsx("button",{onClick:h,disabled:i||!d,className:`
          bg-white p-3 rounded-full shadow-lg border border-gray-200
          hover:bg-gray-50 active:bg-gray-100
          disabled:opacity-50 disabled:cursor-not-allowed
          transition-all duration-200
          ${i?"cursor-wait":"cursor-pointer"}
        `,"aria-label":i?"현재 위치를 찾는 중...":"현재 위치로 이동",title:i?"현재 위치를 찾는 중...":"현재 위치로 이동",children:i?r.jsx("div",{className:"relative",children:(0,r.jsxs)("svg",{className:"animate-spin h-6 w-6 text-blue-500",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):(0,r.jsxs)("svg",{className:"h-6 w-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),o&&r.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-64",children:(0,r.jsxs)("div",{className:"bg-red-100 border border-red-300 text-red-800 text-sm p-3 rounded-lg shadow-lg",children:[(0,r.jsxs)("div",{className:"flex items-start",children:[r.jsx("svg",{className:"w-4 h-4 text-red-500 mt-0.5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium mb-1",children:"위치 정보 오류"}),r.jsx("div",{children:o})]})]}),r.jsx("div",{className:"absolute top-full right-6 -mt-1",children:r.jsx("div",{className:"border-4 border-transparent border-t-red-300"})})]})})]})}function k({className:e=""}){return r.jsx("div",{className:`w-full h-full bg-gray-50 flex items-center justify-center ${e}`,children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"w-64 h-2 bg-gray-200 rounded-full overflow-hidden mx-auto mb-4",children:r.jsx("div",{className:"h-full bg-blue-500 rounded-full animate-pulse",style:{width:"60%"}})}),r.jsx("p",{className:"text-gray-600 font-medium",children:"지도 서비스 초기화 중..."}),r.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Naver Maps API 로딩"})]})})}function R({className:e="",onRetry:t}){return r.jsx("div",{className:`w-full h-full bg-red-50 flex items-center justify-center ${e}`,children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsx("p",{className:"text-red-700 font-medium",children:"지도를 불러올 수 없습니다"}),r.jsx("p",{className:"text-sm text-red-500 mt-1",children:"네트워크 연결을 확인해주세요"}),t&&r.jsx("button",{onClick:t,className:"mt-4 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"다시 시도"})]})})}function D({className:e=""}){let t=(0,n.useRef)(null),[s,a]=(0,n.useState)(!1),[i,l]=(0,n.useState)(null),{mapInstance:o,setMapInstance:c,center:d,zoom:u,setLoading:h,isLoading:m}=x();return m&&!s?r.jsx("div",{className:`w-full h-full ${e}`,children:r.jsx(k,{})}):i?r.jsx("div",{className:`w-full h-full ${e}`,children:r.jsx(R,{onRetry:()=>{l(null),window.location.reload()}})}):r.jsx("div",{className:`relative w-full h-full ${e}`,children:r.jsx("div",{ref:t,className:"w-full h-full",style:{minHeight:"400px"}})})}function C({onClick:e,hasActiveFilters:t=!1}){return r.jsx("button",{onClick:e,className:`
        absolute top-4 right-4 z-10
        bg-white shadow-lg rounded-full p-3
        border border-gray-200
        hover:bg-gray-50 active:bg-gray-100
        transition-colors duration-200
        ${t?"ring-2 ring-blue-500":""}
      `,"aria-label":"필터 열기",children:(0,r.jsxs)("div",{className:"relative",children:[r.jsx("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),t&&r.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-blue-500 rounded-full"})]})})}var M=s(7626),T=s.n(M);function E({min:e,max:t,step:s=1,value:a,onChange:i,formatValue:l=e=>e.toString()}){let[o,c]=(0,n.useState)(a),d=(0,n.useCallback)(t=>{let a=[Math.max(e,Math.min(Number(t.target.value),o[1]-s)),o[1]];c(a),i(a)},[e,s,o,i]),u=(0,n.useCallback)(e=>{let a=Math.min(t,Math.max(Number(e.target.value),o[0]+s)),r=[o[0],a];c(r),i(r)},[t,s,o,i]),h=(o[0]-e)/(t-e)*100,m=(o[1]-e)/(t-e)*100;return(0,r.jsxs)("div",{className:"jsx-e188abccf3957259 w-full space-y-4",children:[(0,r.jsxs)("div",{className:"jsx-e188abccf3957259 relative h-6",children:[r.jsx("div",{className:"jsx-e188abccf3957259 absolute top-3 w-full h-0.5 bg-gray-200 rounded"}),r.jsx("div",{style:{left:`${h}%`,width:`${m-h}%`},className:"jsx-e188abccf3957259 absolute top-3 h-0.5 bg-blue-500 rounded"}),r.jsx("input",{type:"range",min:e,max:t,step:s,value:o[0],onChange:d,style:{zIndex:1},className:"jsx-e188abccf3957259 absolute w-full h-6 bg-transparent appearance-none pointer-events-none focus:outline-none slider-thumb-1"}),r.jsx("input",{type:"range",min:e,max:t,step:s,value:o[1],onChange:u,style:{zIndex:2},className:"jsx-e188abccf3957259 absolute w-full h-6 bg-transparent appearance-none pointer-events-none focus:outline-none slider-thumb-2"})]}),(0,r.jsxs)("div",{className:"jsx-e188abccf3957259 flex justify-between text-sm text-gray-600",children:[r.jsx("span",{className:"jsx-e188abccf3957259 px-2 py-1 bg-gray-100 rounded",children:l(o[0])}),r.jsx("span",{className:"jsx-e188abccf3957259 px-2 py-1 bg-gray-100 rounded",children:l(o[1])})]}),r.jsx(T(),{id:"e188abccf3957259",children:".slider-thumb-1.jsx-e188abccf3957259::-webkit-slider-thumb,.slider-thumb-2.jsx-e188abccf3957259::-webkit-slider-thumb{-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;width:20px;height:20px;background:#3b82f6;border:2px solid white;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;cursor:pointer;pointer-events:all;-webkit-box-shadow:0 2px 4px rgba(0,0,0,.1);-moz-box-shadow:0 2px 4px rgba(0,0,0,.1);box-shadow:0 2px 4px rgba(0,0,0,.1)}.slider-thumb-1.jsx-e188abccf3957259::-moz-range-thumb,.slider-thumb-2.jsx-e188abccf3957259::-moz-range-thumb{width:20px;height:20px;background:#3b82f6;border:2px solid white;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;cursor:pointer;pointer-events:all;-webkit-box-shadow:0 2px 4px rgba(0,0,0,.1);-moz-box-shadow:0 2px 4px rgba(0,0,0,.1);box-shadow:0 2px 4px rgba(0,0,0,.1)}"})]})}let A=[{value:"restaurant",label:"음식점",icon:"\uD83C\uDF7D️"},{value:"retail",label:"소매",icon:"\uD83D\uDECD️"},{value:"office",label:"사무실",icon:"\uD83C\uDFE2"},{value:"etc",label:"기타",icon:"\uD83D\uDCE6"}];function L({selected:e,onChange:t}){let s=s=>{t(e.includes(s)?e.filter(e=>e!==s):[...e,s])};return r.jsx("div",{className:"grid grid-cols-2 gap-2",children:A.map(t=>{let a=e.includes(t.value);return(0,r.jsxs)("button",{onClick:()=>s(t.value),className:`
              flex items-center justify-center space-x-2 p-3 rounded-lg border-2 transition-all
              ${a?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-gray-300"}
            `,type:"button",children:[r.jsx("span",{className:"text-xl",children:t.icon}),r.jsx("span",{className:"text-sm font-medium",children:t.label})]},t.value)})})}function S({value:e="",onChange:t}){let[s,a]=(0,n.useState)(e),[i,l]=(0,n.useState)(!1),[o,c]=(0,n.useState)([]),d=(0,n.useRef)(null),u=(0,n.useRef)(null),h=e=>{a(e),t(e),l(!1)};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("div",{className:"relative",children:[r.jsx("input",{ref:d,type:"text",value:s,onChange:e=>{a(e.target.value),l(!0)},onFocus:()=>{l(!0)},onBlur:()=>{setTimeout(()=>{l(!1)},200)},placeholder:"지역을 검색하세요 (예: 강남구)",className:"w-full px-3 py-2 pr-20 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,r.jsxs)("div",{className:"absolute inset-y-0 right-0 flex items-center",children:[s&&r.jsx("button",{onClick:()=>{a(""),t(""),d.current?.focus()},className:"px-2 text-gray-400 hover:text-gray-600",type:"button",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),r.jsx("button",{onClick:()=>{t(s),l(!1)},className:"px-3 py-1 text-sm text-blue-600 hover:text-blue-800 border-l border-gray-300",type:"button",children:"적용"})]})]}),i&&r.jsx("div",{ref:u,className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:0===o.length?r.jsx("div",{className:"px-3 py-2 text-gray-500",children:"검색 결과가 없습니다"}):o.map(e=>r.jsx("button",{onClick:()=>h(e),className:"w-full px-3 py-2 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none",type:"button",children:e},e))})]})}function I({initialFilters:e,onApplyFilters:t,onClose:s}){let[a,i]=(0,n.useState)(e);return(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg space-y-6 max-h-[80vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("h2",{className:"text-lg font-semibold",children:"필터"}),r.jsx("button",{onClick:s,className:"text-gray-500 hover:text-gray-700 p-1","aria-label":"닫기",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-medium mb-3",children:"월 임대료 범위"}),r.jsx(E,{min:0,max:1e3,step:10,value:a.rentRange,onChange:e=>{i(t=>({...t,rentRange:e}))},formatValue:e=>`${e}만원`})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-medium mb-3",children:"면적 범위"}),r.jsx(E,{min:0,max:100,step:1,value:a.areaRange,onChange:e=>{i(t=>({...t,areaRange:e}))},formatValue:e=>`${e}평`})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-medium mb-3",children:"상가 유형"}),r.jsx(L,{selected:a.shopTypes,onChange:e=>{i(t=>({...t,shopTypes:e}))}})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-medium mb-3",children:"지역 검색"}),r.jsx(S,{value:a.region,onChange:e=>{i(t=>({...t,region:e||void 0}))}})]})]}),(0,r.jsxs)("div",{className:"flex space-x-2 pt-4 border-t border-gray-200",children:[r.jsx("button",{onClick:()=>{i({rentRange:[0,1e3],areaRange:[0,100],shopTypes:["restaurant","retail","office","etc"],region:void 0})},className:"flex-1 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors",children:"초기화"}),r.jsx("button",{onClick:()=>{t(a),s()},className:"flex-1 py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:"적용하기"})]})]})}function O({message:e="필터를 적용하는 중..."}){return r.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-80 z-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 flex items-center space-x-3",children:[r.jsx("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),r.jsx("span",{className:"text-gray-700 font-medium",children:e})]})})}var _=s(8016),$=s(6462),z=s(2458);let P=(0,l.Ue)((e,t)=>({isOpen:!1,shopId:null,height:"partial",isAnimating:!1,openSheet:t=>{e({isOpen:!0,shopId:t,height:"partial",isAnimating:!0})},closeSheet:()=>{e({isOpen:!1,height:"partial",isAnimating:!0})},clearShopId:()=>{e({shopId:null})},setHeight:s=>{t().height!==s&&e({height:s,isAnimating:!0})},setAnimating:t=>{e({isAnimating:t})}}));function U({children:e,minHeight:t=80,className:s="",backdrop:a=!0,closeOnBackdropClick:i=!0,dragHandle:l=!0}){let{isOpen:o,height:c,closeSheet:d,setHeight:u,setAnimating:h,isAnimating:m,clearShopId:x}=P(),p=(0,_._)(),g=(0,n.useRef)(null),[f,b]=(0,n.useState)(800),[j,y]=(0,n.useState)({collapsed:0,partial:320,full:680});(0,n.useCallback)(e=>{switch(e){case"collapsed":return"translateY(100%)";case"partial":default:return`translateY(calc(100% - ${j.partial}px))`;case"full":return`translateY(calc(100% - ${j.full}px))`}},[j.partial,j.full]);let v=Math.max(j.full,.9*f);return r.jsx($.M,{mode:"wait",children:(o||m)&&(0,r.jsxs)(r.Fragment,{children:[a&&r.jsx(z.E.div,{className:"fixed inset-0 bg-black bg-opacity-50 z-40",initial:{opacity:0},animate:{opacity:o?1:0},exit:{opacity:0},transition:{duration:.3},onClick:()=>{i&&d()}}),(0,r.jsxs)(z.E.div,{ref:g,className:`fixed bottom-0 left-0 right-0 bg-white rounded-t-2xl z-50 overflow-hidden shadow-2xl ${s}`,initial:{transform:"translateY(100%)"},animate:p,exit:{transform:"translateY(100%)",transition:{duration:.3,ease:[.4,0,.2,1]}},drag:"y",dragConstraints:{top:-(j.full-j.partial),bottom:v-j.partial},dragElastic:{top:.1,bottom:.2},onDragEnd:(e,t)=>{let s;let{offset:a,velocity:r}=t;"collapsed"===(s=Math.abs(r.y)>500?r.y>0?"full"===c?"partial":"collapsed":"partial"===c?"full":"partial":a.y>100?"full"===c?"partial":"collapsed":a.y<-100?"partial"===c?"full":"partial":c)?d():u(s)},style:{height:v,minHeight:t},children:[l&&r.jsx("div",{className:"flex justify-center pt-3 pb-2",children:r.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full cursor-grab active:cursor-grabbing"})}),r.jsx("div",{className:"flex-1 overflow-y-auto px-4 pb-4",style:{maxHeight:"full"===c?j.full-40:j.partial-40},children:e})]},"bottom-sheet")]})})}function F({className:e=""}){return(0,r.jsxs)("div",{className:`space-y-4 animate-pulse ${e}`,children:[r.jsx("div",{className:"h-7 bg-gray-200 rounded-lg w-3/4"}),(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx("div",{className:"h-48 bg-gray-200 rounded-lg"}),r.jsx("div",{className:"flex space-x-2 overflow-hidden",children:[1,2,3].map(e=>r.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-md flex-shrink-0"},e))})]}),r.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"})]},e))}),r.jsx("div",{className:"border-t border-gray-100 pt-4",children:(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/3"}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})]})}),r.jsx("div",{className:"border-t border-gray-100 pt-4",children:(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/3"}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),r.jsx("div",{className:"h-10 bg-gray-200 rounded-lg w-20"})]}),r.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})]})}function B({images:e,shopName:t="상점"}){let[s,a]=(0,n.useState)(0);if(!e||0===e.length)return r.jsx("div",{className:"h-48 bg-gray-200 flex items-center justify-center rounded-lg",children:(0,r.jsxs)("div",{className:"text-center text-gray-500",children:[r.jsx("div",{className:"text-2xl mb-2",children:"\uD83C\uDFEA"}),r.jsx("span",{children:"이미지가 없습니다"})]})});let l=e=>{a(e)},o=e=>{e.target.src=`data:image/svg+xml;base64,${btoa(`
      <svg width="400" height="300" xmlns="http://www.w3.org/2000/svg">
        <rect width="100%" height="100%" fill="#f3f4f6"/>
        <text x="50%" y="50%" text-anchor="middle" dy=".3em" font-family="system-ui" font-size="16" fill="#9ca3af">
          Image Load Failed
        </text>
      </svg>
    `)}`};return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"relative h-48 rounded-lg overflow-hidden bg-gray-100",children:[r.jsx(i.default,{src:e[s],alt:`${t} 메인 이미지`,fill:!0,className:"object-cover transition-all duration-300",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",priority:0===s,onError:o}),e.length>1&&(0,r.jsxs)("div",{className:"absolute top-2 right-2 bg-black bg-opacity-60 text-white text-xs px-2 py-1 rounded-full",children:[s+1," / ",e.length]})]}),e.length>1&&r.jsx("div",{className:"flex gap-2 overflow-x-auto py-1",children:e.map((e,a)=>(0,r.jsxs)("button",{className:`relative flex-shrink-0 w-16 h-16 rounded-md overflow-hidden border-2 transition-all duration-200 ${a===s?"border-blue-500 shadow-md":"border-gray-200 hover:border-gray-300"}`,onClick:()=>l(a),"aria-label":`${t} 이미지 ${a+1} 보기`,children:[r.jsx(i.default,{src:e,alt:`${t} 썸네일 ${a+1}`,fill:!0,className:"object-cover",sizes:"64px",onError:o}),a===s&&r.jsx("div",{className:"absolute inset-0 bg-blue-500 bg-opacity-20 flex items-center justify-center",children:r.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})})]},a))}),e.length>0&&r.jsx("p",{className:"text-xs text-gray-500 text-center",children:1===e.length?"상점 이미지":`총 ${e.length}장의 이미지 • 썸네일을 클릭하여 확대 보기`})]})}function q(){let{shopId:e,setHeight:t}=P(),[s,a]=(0,n.useState)(null),[i,l]=(0,n.useState)(!1),[o,c]=(0,n.useState)(null),d=e=>{window.location.href=`tel:${e}`},u=e=>{window.location.href=`mailto:${e}`};return i?r.jsx("div",{className:"p-4",children:r.jsx(F,{})}):o?r.jsx("div",{className:"p-4",children:r.jsx(h,{title:"상점 정보 로딩 실패",message:o,onRetry:()=>{c(null)},size:"medium"})}):s?(0,r.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,r.jsxs)("div",{className:"border-b border-gray-100 pb-4",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:s.name}),r.jsx("p",{className:"text-sm text-gray-600 mb-3",children:s.address}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("span",{className:"text-lg font-bold text-blue-600",children:["월세 ",s.monthlyRent.toLocaleString(),"만원"]}),(0,r.jsxs)("span",{className:"text-sm text-gray-500 ml-2",children:["/ 보증금 ",s.deposit.toLocaleString(),"만원"]})]}),(0,r.jsxs)("span",{className:"text-sm bg-gray-100 px-2 py-1 rounded",children:[s.area,"평"]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>d(s.contact.phone),className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"\uD83D\uDCDE 전화하기"}),r.jsx("button",{onClick:()=>{t("full")},className:"flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"\uD83D\uDCCB 자세히 보기"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-md font-semibold text-gray-900 mb-3",children:"사진"}),r.jsx(B,{images:s.images,shopName:s.name})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-md font-semibold text-gray-900 mb-2",children:"기본 정보"}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-500",children:"업종"}),r.jsx("span",{children:(e=>{switch(e){case"restaurant":return"음식점";case"retail":return"소매";case"office":return"사무실";default:return"기타"}})(s.shopType)})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-500",children:"면적"}),(0,r.jsxs)("span",{children:[s.area,"평"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-500",children:"월 임대료"}),(0,r.jsxs)("span",{children:[s.monthlyRent.toLocaleString(),"만원"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-500",children:"보증금"}),(0,r.jsxs)("span",{children:[s.deposit.toLocaleString(),"만원"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-500",children:"입주 가능일"}),r.jsx("span",{children:s.availableFrom||"문의"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-md font-semibold text-gray-900 mb-2",children:"설명"}),r.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:s.description})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-md font-semibold text-gray-900 mb-2",children:"특징"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:s.features?.map((e,t)=>r.jsx("span",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded-full",children:e},t))||r.jsx("span",{className:"text-sm text-gray-500",children:"특징 정보가 없습니다."})})]}),(0,r.jsxs)("div",{className:"border-t pt-4",children:[r.jsx("h3",{className:"text-md font-semibold text-gray-900 mb-2",children:"연락처"}),r.jsx("div",{className:"space-y-2",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium",children:s.contact.agent||"담당자 정보 없음"}),r.jsx("p",{className:"text-sm text-gray-600",children:s.contact.phone})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>d(s.contact.phone),className:"bg-green-600 text-white px-3 py-1 text-sm rounded hover:bg-green-700 transition-colors",children:"\uD83D\uDCDE 전화"}),s.contact.email&&r.jsx("button",{onClick:()=>u(s.contact.email),className:"bg-blue-600 text-white px-3 py-1 text-sm rounded hover:bg-blue-700 transition-colors",children:"✉️ 메일"})]})]})})]})]}):r.jsx("div",{className:"p-4",children:r.jsx(h,{title:"상점 정보 없음",message:"상점 정보를 찾을 수 없습니다.",size:"medium"})})}let H=({enableAutoDetection:e=!0,fallbackToDefault:t=!0,timeout:s=8e3,onLocationDetected:a,onError:r}={})=>{let[i,l]=(0,n.useState)({isDetecting:!1,hasDetected:!1,error:null,position:null,permissionStatus:null}),{mapInstance:o,setCenter:c}=x(),d=(0,n.useRef)(!1),u=(0,n.useRef)(!1),h=(0,n.useCallback)(e=>{a?.(e)},[a]),m=(0,n.useCallback)(e=>{r?.(e)},[r]),p=(0,n.useRef)(!1),g=(0,n.useCallback)(async()=>{if(!d.current&&!p.current&&e){if(!y()){d.current=!0;return}try{u.current=!1,d.current=!0,p.current=!0,l(e=>({...e,isDetecting:!0,error:null}));let e=await v();if(u.current)return;if(l(t=>({...t,permissionStatus:e})),"denied"===e){p.current=!1,l(e=>({...e,isDetecting:!1,hasDetected:!0}));return}let t=await N({enableHighAccuracy:!1,timeout:s,maximumAge:3e5});if(u.current)return;let a={lat:t.coords.latitude,lng:t.coords.longitude};if(o&&window.naver&&window.naver.maps){let e=new window.naver.maps.LatLng(a.lat,a.lng);o.setCenter(e)}c(a),p.current=!1,l(e=>({...e,isDetecting:!1,hasDetected:!0,position:t,error:null})),h(t)}catch(t){if(u.current)return;let e=t instanceof b?t.message:"위치 정보를 가져올 수 없습니다.";p.current=!1,l(t=>({...t,isDetecting:!1,hasDetected:!0,error:e})),t instanceof b&&m(t)}}},[e,t,s,h,m,c,o]);(0,n.useEffect)(()=>(o&&!d.current&&g(),()=>{u.current=!0}),[o,g]);let f=(0,n.useCallback)(async()=>{if(!p.current){d.current=!1,p.current=!0;try{l(e=>({...e,isDetecting:!0,error:null}));let e=await N({enableHighAccuracy:!0,timeout:s}),t={lat:e.coords.latitude,lng:e.coords.longitude};if(o&&window.naver&&window.naver.maps){let e=new window.naver.maps.LatLng(t.lat,t.lng);o.setCenter(e),o.setZoom(16)}c(t),p.current=!1,l(t=>({...t,isDetecting:!1,hasDetected:!0,position:e,error:null})),h(e)}catch(t){let e=t instanceof b?t.message:"위치 정보를 가져올 수 없습니다.";p.current=!1,l(t=>({...t,isDetecting:!1,error:e})),t instanceof b&&m(t)}}},[s,o,c,h,m]);return{...i,retryDetection:f,isSupported:y()}},V=s(4099).Z.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"},timeout:1e4});V.interceptors.request.use(e=>(e.metadata={startTime:Date.now()},e),e=>(console.error("❌ Request Error:",e),Promise.reject(e))),V.interceptors.response.use(e=>{let t=e.config;return t.metadata?.startTime&&(Date.now(),t.metadata.startTime),e},e=>{let t=e.config,s=t?.metadata?.startTime?Date.now()-t.metadata.startTime:0;console.error("❌ API Error:",{method:t?.method?.toUpperCase(),url:t?.url,status:e.response?.status,responseTime:s?`${s}ms`:"N/A",message:e.message,data:e.response?.data});let a={code:"UNKNOWN_ERROR",message:"알 수 없는 오류가 발생했습니다."};if(e.response){let t=e.response.status,s=e.response.data;switch(t){case 400:a.code="BAD_REQUEST",a.message="잘못된 요청입니다.";break;case 401:a.code="UNAUTHORIZED",a.message="인증이 필요합니다.";break;case 403:a.code="FORBIDDEN",a.message="접근 권한이 없습니다.";break;case 404:a.code="NOT_FOUND",a.message="요청한 데이터를 찾을 수 없습니다.";break;case 500:a.code="INTERNAL_SERVER_ERROR",a.message="서버 내부 오류가 발생했습니다.";break;default:a.code=`HTTP_${t}`,a.message=s?.message||`HTTP ${t} 오류가 발생했습니다.`}a.details=s}else e.request?(a.code="NETWORK_ERROR",a.message="네트워크 연결을 확인해주세요."):"ECONNABORTED"===e.code&&(a.code="TIMEOUT_ERROR",a.message="요청 시간이 초과되었습니다.");return Promise.reject(a)});let Z=[{id:"shop-001",name:"부산진구 카페 공실",address:"부산광역시 부산진구 중앙대로 708",latitude:35.2289,longitude:129.0813,area:15,monthlyRent:180,deposit:1e3,shopType:"restaurant",images:["https://via.placeholder.com/400x300/f0f0f0/333333?text=카페+전경","https://via.placeholder.com/400x300/f8f8f8/333333?text=내부+모습"],contact:{phone:"051-1234-5678",email:"info@sample-cafe.com"},description:"부산진구 중심가 근처의 좋은 접근성을 가진 카페 공실입니다. 직장인들이 많은 지역으로 매출이 안정적입니다.",createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-20")},{id:"shop-002",name:"서면역 소매점 공실",address:"부산광역시 부산진구 서면로 38",latitude:35.225,longitude:129.085,area:25,monthlyRent:250,deposit:1500,shopType:"retail",images:["https://via.placeholder.com/400x300/e0e0e0/333333?text=매장+외관"],contact:{phone:"051-2345-6789"},description:"서면역 근처의 소매점 공실로 유동인구가 많은 위치입니다.",createdAt:new Date("2024-01-10"),updatedAt:new Date("2024-01-18")},{id:"shop-003",name:"부산진구 사무실",address:"부산광역시 부산진구 동천로 109",latitude:35.232,longitude:129.078,area:40,monthlyRent:120,deposit:800,shopType:"office",images:[],contact:{phone:"051-3456-7890",email:"office@busanjin.com"},description:"부산진구 중심가의 사무실 공간입니다. 조용한 업무 환경을 제공합니다.",createdAt:new Date("2024-01-12"),updatedAt:new Date("2024-01-22")},{id:"shop-004",name:"전포동 음식점 공실",address:"부산광역시 부산진구 전포대로 175",latitude:35.226,longitude:129.079,area:20,monthlyRent:200,deposit:1200,shopType:"restaurant",images:["https://via.placeholder.com/400x300/f5f5f5/333333?text=음식점+내부"],contact:{phone:"051-4567-8901"},description:"전포카페거리 근처의 음식점 공실입니다. 젊은층 고객이 많은 지역입니다.",createdAt:new Date("2024-01-08"),updatedAt:new Date("2024-01-25")},{id:"shop-005",name:"부전동 기타 상가",address:"부산광역시 부산진구 중앙대로 668",latitude:35.231,longitude:129.084,area:30,monthlyRent:150,deposit:900,shopType:"etc",images:[],contact:{phone:"051-5678-9012",email:"info@bujeon.com"},description:"부전동 상업지구의 다목적 상가 공간입니다.",createdAt:new Date("2024-01-05"),updatedAt:new Date("2024-01-28")}];Z.map(e=>({id:e.id,position:{lat:e.latitude,lng:e.longitude},shopType:e.shopType,isActive:!0,name:e.name,monthlyRent:e.monthlyRent}));let W=(e,t)=>e.filter(e=>{let s=e.monthlyRent>=t.rentRange[0]&&e.monthlyRent<=t.rentRange[1],a=e.area>=t.areaRange[0]&&e.area<=t.areaRange[1],r=t.shopTypes.includes(e.shopType),n=!t.region||e.address.includes(t.region);return s&&a&&r&&n});class K{constructor(){this.cache=new Map,this.stats={hits:0,misses:0,totalRequests:0,memoryUsage:0,hitRate:0},this.DEFAULT_TTL=3e5,this.LONG_TTL=18e5,this.SHORT_TTL=6e4,this.MAX_MEMORY_SIZE=52428800,this.CLEANUP_INTERVAL=6e4,setInterval(()=>this.cleanup(),this.CLEANUP_INTERVAL)}generateKey(e,t){if(!t)return e;let s=Object.keys(t).sort().reduce((e,s)=>{let a=t[s];return null!=a&&(e[s]=Array.isArray(a)?a.sort().join(","):String(a)),e},{});return`${e}:${JSON.stringify(s)}`}estimateSize(e){try{return new Blob([JSON.stringify(e)]).size}catch{return 2*JSON.stringify(e).length}}get(e,t){let s=this.generateKey(e,t),a=this.cache.get(s);return(this.stats.totalRequests++,!a||Date.now()>a.expiresAt)?(this.stats.misses++,a&&(this.cache.delete(s),this.stats.memoryUsage-=a.size),this.updateHitRate(),null):(this.stats.hits++,this.updateHitRate(),a.timestamp=Date.now(),a.data)}set(e,t,s,a){let r=this.generateKey(e,a),n=this.estimateSize(t),i=Date.now(),l=i+(s||this.DEFAULT_TTL);this.stats.memoryUsage+n>this.MAX_MEMORY_SIZE&&this.evictLRU();let o=this.cache.get(r);o&&(this.stats.memoryUsage-=o.size),this.cache.set(r,{data:t,timestamp:i,expiresAt:l,size:n}),this.stats.memoryUsage+=n}evictLRU(){let e=null,t=Date.now();if(Array.from(this.cache.entries()).forEach(([s,a])=>{a.timestamp<t&&(t=a.timestamp,e=s)}),e){let t=this.cache.get(e);this.cache.delete(e),this.stats.memoryUsage-=t.size}}cleanup(e=!1){let t=Date.now(),s=[];Array.from(this.cache.entries()).forEach(([a,r])=>{let n=t>r.expiresAt,i=e&&t-r.timestamp>this.DEFAULT_TTL;(n||i)&&(s.push(a),this.stats.memoryUsage-=r.size)}),s.forEach(e=>this.cache.delete(e))}updateHitRate(){this.stats.hitRate=this.stats.totalRequests>0?this.stats.hits/this.stats.totalRequests:0}invalidate(e){let t=[],s=0;return Array.from(this.cache.entries()).forEach(([a,r])=>{a.includes(e)&&(t.push(a),s+=r.size)}),t.forEach(e=>this.cache.delete(e)),this.stats.memoryUsage-=s,t.length}getStats(){return{...this.stats}}clear(){this.cache.clear(),this.stats={hits:0,misses:0,totalRequests:0,memoryUsage:0,hitRate:0}}}let G=new K;class Y{static{this.DEFAULT_MAX_MARKERS=500}static{this.DEFAULT_MIN_ZOOM=10}static filterByBounds(e,t){return e.filter(e=>e.latitude>=t.south&&e.latitude<=t.north&&e.longitude>=t.west&&e.longitude<=t.east)}static prioritizeByDistance(e,t,s){return e.map(e=>({...e,distance:this.calculateDistance(t,s,e.latitude,e.longitude)})).sort((e,t)=>e.distance-t.distance).slice(0,this.DEFAULT_MAX_MARKERS)}static calculateDistance(e,t,s,a){let r=this.toRad(s-e),n=this.toRad(a-t),i=Math.sin(r/2)*Math.sin(r/2)+Math.cos(this.toRad(e))*Math.cos(this.toRad(s))*Math.sin(n/2)*Math.sin(n/2);return 2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))*6371}static toRad(e){return e*Math.PI/180}static filterByZoom(e,t,s={}){let a=s.minZoomLevel||this.DEFAULT_MIN_ZOOM,r=s.maxMarkers||this.DEFAULT_MAX_MARKERS;return t<a?e.sort((e,t)=>t.monthlyRent-e.monthlyRent).slice(0,Math.floor(r/3)):e.slice(0,r)}static optimizeMarkers(e,t){let s=[...e];return t.bounds&&(s=this.filterByBounds(s,t.bounds)),void 0!==t.currentZoom&&(s=this.filterByZoom(s,t.currentZoom,t)),t.centerLat&&t.centerLng&&(s=this.prioritizeByDistance(s,t.centerLat,t.centerLng)),s}}class X{static{this.metrics={}}static startTiming(e){let t=performance.now();return()=>{let s=performance.now();this.metrics[e]||(this.metrics[e]=[]),this.metrics[e].push(s-t),this.metrics[e].length>10&&this.metrics[e].shift()}}static getAverageTime(e){let t=this.metrics[e]||[];return t.length>0?t.reduce((e,t)=>e+t,0)/t.length:0}static getMetrics(){let e={};return Object.keys(this.metrics).forEach(t=>{let s=this.metrics[t];e[t]={current:s[s.length-1]||0,average:this.getAverageTime(t)}}),e}}class J{static getInstance(){return J.instance||(J.instance=new J),J.instance}constructor(){this.cache=new Map,this.CACHE_TTL=3e5}getCacheKey(e,t){return`${e}:${JSON.stringify(t||{})}`}async getCachedData(e,t,s,a){let r=X.startTiming(`API:${e}`);try{let n=G.get(e,a);if(n)return r(),n;let i=await t();return G.set(e,i,s,a),i}finally{r()}}getFromCache(e){let t=this.cache.get(e);return t?Date.now()-t.timestamp>this.CACHE_TTL?(this.cache.delete(e),null):t.data:null}setCache(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}get useMockData(){return!0}async getShops(e={}){let t=this.getCacheKey("getShops",e),s=this.getFromCache(t);if(s)return s;try{if(this.useMockData)return this.getMockShops(e);let s=await V.get("/shops",{params:e});if(!s.data.success||!s.data.data)throw Error(s.data.error||"Failed to fetch shops");let a=s.data.data;return this.setCache(t,a),a}catch(t){if(console.error("Failed to fetch shops:",t),!this.useMockData)return this.getMockShops(e);throw t}}async getShopById(e){let t=this.getCacheKey("getShopById",{id:e}),s=this.getFromCache(t);if(s)return s;try{if(this.useMockData){let s=Z.find(t=>t.id===e);if(!s)throw{code:"NOT_FOUND",message:"해당 상가를 찾을 수 없습니다."};return this.setCache(t,s),s}let s=await V.get(`/shops/${e}`);if(!s.data.success||!s.data.data)throw Error(s.data.error||"Failed to fetch shop");let a=s.data.data;return this.setCache(t,a),a}catch(s){if(console.error(`Failed to fetch shop ${e}:`,s),!this.useMockData){let s=Z.find(t=>t.id===e);if(s)return this.setCache(t,s),s}throw s}}getMockShops(e){let t=[...Z];e.filter&&(t=W(t,{rentRange:e.filter.rentRange||[0,1e3],areaRange:e.filter.areaRange||[0,100],shopTypes:e.filter.shopTypes||["restaurant","retail","office","etc"],region:e.filter.region})),e.sortBy&&t.sort((t,s)=>{let a,r;switch(e.sortBy){case"rent":a=t.monthlyRent,r=s.monthlyRent;break;case"area":a=t.area,r=s.area;break;case"createdAt":a=t.createdAt,r=s.createdAt;break;default:return 0}return"desc"===e.sortOrder?a<r?1:-1:a>r?1:-1});let s=e.limit||20,a=e.offset||0;return{items:t.slice(a,a+s),total:t.length,limit:s,offset:a,hasMore:a+s<t.length}}clearCache(){this.cache.clear()}invalidateShopCache(e){e?Array.from(this.cache.keys()).filter(t=>t.includes(`"id":"${e}"`)||t.includes("getShops")).forEach(e=>this.cache.delete(e)):this.clearCache()}}let Q=J.getInstance(),ee=e=>Q.getShops(e);function et({message:e="로딩 중...",size:t="md"}){return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center p-8",children:[r.jsx("div",{className:`${{sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[t]} animate-spin`,children:(0,r.jsxs)("svg",{className:"w-full h-full text-primary-600",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),r.jsx("p",{className:"mt-4 text-sm text-gray-600 text-center",children:e})]})}function es(){let[e,t]=(0,n.useState)(!1),[s,a]=(0,n.useState)([]),[i,l]=(0,n.useState)(!0),[o,m]=(0,n.useState)(!1),[x,p]=(0,n.useState)(null),[g,b]=(0,n.useState)(null),{openSheet:j}=P(),{filters:y,appliedFilters:v,isFilterPanelOpen:N,applyFilters:k,openFilterPanel:R,closeFilterPanel:M,isDefaultFilter:T}=c(),E=(0,n.useCallback)(e=>{},[]),A=(0,n.useCallback)(e=>{console.warn("\uD83D\uDCCD 위치 오류:",e.message)},[]),L=H({enableAutoDetection:e,fallbackToDefault:!0,timeout:8e3,onLocationDetected:E,onError:A}),S=(0,n.useCallback)(async e=>{let t=X.startTiming("FetchShops");try{m(!0),p(null),b(null);let t=await ee({limit:100,filter:e});a(t.items)}catch(e){console.error("❌ Failed to load shops:",e),e&&"object"==typeof e&&e.code?b(e):p(e?.message||"상가 데이터를 불러오는데 실패했습니다.")}finally{m(!1),i&&l(!1),t()}},[i]),_=(0,n.useMemo)(()=>s,[s]),$=(0,n.useMemo)(()=>(function(e){let t=[];if((e.rentRange[0]>0||e.rentRange[1]<1e3)&&t.push(`임대료 ${e.rentRange[0]}-${e.rentRange[1]}만원`),(e.areaRange[0]>0||e.areaRange[1]<100)&&t.push(`면적 ${e.areaRange[0]}-${e.areaRange[1]}평`),e.shopTypes.length<4){let s=e.shopTypes.map(e=>{switch(e){case"restaurant":return"음식점";case"retail":return"소매";case"office":return"사무실";case"etc":return"기타";default:return e}});t.push(`유형: ${s.join(", ")}`)}return e.region&&t.push(`지역: ${e.region}`),t.length>0?t.join(" | "):"전체"})(v),[v]),z=function(e,t){let s=(0,n.useRef)(null);return(0,n.useCallback)((...t)=>{s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{e(...t)},500)},[e,500])}(S,500),F=(0,n.useCallback)(e=>{j(e)},[j]),B=(0,n.useCallback)(e=>{k(e)},[k]),V=(0,n.useCallback)(()=>{p(null),b(null),l(!0),z(v)},[z,v]);return e?i&&!s.length?(0,r.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50",children:[r.jsx(d,{}),r.jsx(u,{}),r.jsx("main",{className:"flex-1 flex items-center justify-center",children:r.jsx(et,{message:"상가 정보를 불러오는 중...",size:"lg"})})]}):(x||g)&&!s.length?(0,r.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50",children:[r.jsx(d,{}),r.jsx(u,{}),r.jsx("main",{className:"flex-1 flex items-center justify-center p-4",children:r.jsx(h,{title:g?.code==="NETWORK_ERROR"?"네트워크 연결 오류":"데이터 로딩 실패",message:g?.message||x||"상가 데이터를 불러오는데 실패했습니다.",errorCode:g?.code,onRetry:V,showDetails:!0,size:"large"})})]}):(0,r.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50",children:[r.jsx(d,{}),r.jsx(u,{}),(0,r.jsxs)("main",{className:"flex-1 overflow-hidden relative",children:[r.jsx(D,{className:"h-full w-full"}),_.length>0&&r.jsx(f,{shops:_,onMarkerClick:F}),r.jsx(C,{onClick:R,hasActiveFilters:!T()}),r.jsx(w,{onLocationFound:E,onError:A}),(0,r.jsxs)("div",{className:"absolute bottom-4 left-4 bg-white rounded-lg shadow-lg p-3 z-10 max-w-xs",children:[r.jsx("div",{className:"flex items-center justify-between mb-2",children:(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-700",children:["\uD83D\uDCCD ",_.length,"개의 공실 상가"]})}),!T()&&r.jsx("div",{className:"text-xs text-blue-600 mb-2",children:$}),L.isDetecting&&(0,r.jsxs)("div",{className:"text-xs text-green-600 flex items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin w-3 h-3 mr-1",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"위치 감지 중..."]}),(x||g)&&s.length>0&&r.jsx("div",{className:"text-xs text-red-600 mt-1",children:"⚠️ 일부 데이터 로딩 실패"})]}),o&&r.jsx(O,{}),N&&r.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4",children:r.jsx("div",{className:"w-full max-w-md",children:r.jsx(I,{initialFilters:y,onApplyFilters:B,onClose:M})})})]}),r.jsx(U,{children:r.jsx(q,{})})]}):(0,r.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50",children:[r.jsx(d,{}),r.jsx(u,{}),r.jsx("main",{className:"flex-1 flex items-center justify-center",children:r.jsx(et,{message:"앱을 초기화하는 중...",size:"lg"})})]})}},908:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>l});var a=s(8570);let r=(0,a.createProxy)(String.raw`/Users/junbookpro/Documents/study/vacant-shop-map/app/page.tsx`),{__esModule:n,$$typeof:i}=r;r.default;let l=(0,a.createProxy)(String.raw`/Users/junbookpro/Documents/study/vacant-shop-map/app/page.tsx#default`)}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[216,351],()=>s(8631));module.exports=a})();